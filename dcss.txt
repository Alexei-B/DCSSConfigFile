# Got suggestions/improvements?
# Got suggestions/improvements?
# https://github.com/HilariousDeathArtist/DCSSConfigFile
# or find me on crawl.s-z.org

<
  function ready()
    AnnounceDamage()
    SpoilerAlert()
    OpenSkills()
  end

  function sendkeys(command)
    crawl.flush_input()
    crawl.sendkeys(command)
    coroutine.yield(true)
    crawl.flush_input()
  end 
>

######################
#    Safe Travel     #
######################
-- To use this create a macro with the following function call
-- ===safetravel
-- Rests up to at least 75% hp (or missing at least 30hp) and 50% mp (or missing at least 20mp)
-- Eats chunks automatically, handled by auto_eat_chunks interface option
-- Travels to the nearest corpse if we have no chunks and are at Very Hungry or Hungry or using Gourmand and at Full
-- Automatically chops valid corpses if we are standing on them and we have no chunks
-- Will stop autotravel at Near Starving
-- TODO: better detection of non-edible corpses before standing on them
-- NOTE: If you don't have rP you will still chop poisonous corpses, but not pick up their chunks

: function safetravel()
:   local mp, max_mp = you.mp()
:   local hp, max_hp = you.hp()
:   local first_monster = next(getMonsterList())
:   local already_checked = (no_results() or dont_know_how_to_get_there())
:   local is_safe = (first_monster == nil)
:   local missing_mp = (mp < max_mp)
:   local missing_hp = (hp < max_hp)
:   local have_no_chunks = have_no_chunks()
:   local you_are_sif = string.find(you.god(), "Sif")
:   local you_are_mummy = string.find(you.race(), "Mummy")
:   local lichform = string.find(you.transform(), "lich")
:   local you_are_sifmummy = you_are_sif and you_are_mummy
:   local you_are_regen = you.regenerating()
:   local you_know_regen = known_spells["Regeneration"]
:   local gourmand_and_hungry = you_are_gourmand() and not you_are_engorged()
:   local have_spare_chunks = not have_no_chunks and not you_are_hungry()
:   local you_have_staff_of_energy = have_staff_of_energy()
:   local you_want_spare_chunks = (not have_spare_chunks) and (you_know_regen or you_have_staff_of_energy or (you_are_sif and not you_are_mummy))
:   local you_want_chunks = have_no_chunks and (you_are_hungry() or gourmand_and_hungry or you_want_spare_chunks)
:   local staff_of_energy_is_equipped = staff_of_energy_is_equipped()
:   local you_are_hungerless = you_are_mummy or lichform
:   --crawl.mpr(string.format("you_want_chunks is: %s", you_want_chunks and "True" or "False"))
:   if (is_safe) then 
:     if (missing_mp and you_are_sifmummy) or (have_spare_chunks and you_are_sif) then
:       crawl.mpr("<green>Autochanneling using Sif.</green>")
:       sendkeys('aa')
:     elseif (missing_hp and you_know_regen and have_spare_chunks and not you_are_regen) then
:       crawl.mpr("<green>Autocasting Regen.</green>")
:       --This assumes casting regen is bound to zr
:       sendkeys('zr')
:     elseif (missing_mp and staff_of_energy_is_equipped and (have_spare_chunks or you_are_hungerless)) then
:       crawl.mpr("<green>Autochanneling using staff of energy.</green>")
:       sendkeys('v')
:     elseif you_want_chunks and on_corpses() and not on_chunks() then 
:       crawl.mpr("<green>Autochopping corpse.</green>")
:       sendkeys('c')
:     elseif you_are_near_starving() then
:       crawl.mpr("<lightred>You should find something to eat.</lightred>")      
:     elseif should_rest(hp, mp, max_hp, max_mp) then
:       rest()
:     elseif you_want_chunks and (not (on_chunks() or already_checked)) then
:       crawl.mpr("<yellow>You may need something to eat soon, looking for food.</yellow>")
:       find_corpses()
:     else
:       --This does the general travelling
:       autoexplore()
:     end
:   else 
:     --This will provide the "foo is nearby" message 
:     autoexplore()
:   end
: end
  
<
  function should_rest(hp, mp, max_hp, max_mp)
    return (mp < (max_mp*0.50) 
            or (hp < (max_hp*0.75)) 
            or ((max_hp-hp) > 30) 
            or ((max_mp-mp) > 20) 
            or (you.slowed()) 
            or (you.poisoned()) 
            or (you.confused())
            or (you.exhausted())
            or (((hp < max_hp) or (mp < max_mp)) and you_are_mummy))
  end

  -- Hungry, Very Hungry, Near Starving, Starving
  function you_are_hungry()
    return not you_are_not_hungry() and ((string.find(you.hunger_name(), "hungry")) or you_are_near_starving())
  end

  -- Normal Satiation
  function you_are_not_hungry()
    return (string.find(you.hunger_name(), "not hungry"))
  end

  -- Engorged
  function you_are_engorged()
    return (string.find(you.hunger_name(), "completely stuffed"))
  end

  -- Near Starving, Starving
  function you_are_near_starving()
    return (string.find(you.hunger_name(), "starving"))
  end

  function autoexplore()
    sendkeys('o')
  end

  function no_results()
    return string.find(crawl.messages(10), escape("Can't find anything matching that")) 
        or string.find(crawl.messages(10), escape("You may need something to eat soon"))   
  end

  function dont_know_how_to_get_there()
    return string.find(crawl.messages(10), escape("know how to get there"))
        or string.find(crawl.messages(10), escape("Have to go through"))
  end

  function rest()
    sendkeys('5')
  end

  function you_are_gourmand()
    return you.gourmand()
  end

  function have_no_chunks()
    for it in inventory() do
       if string.find(it.name(), "chunk") and not string.find(it.name(), "rotting") then
        return false
      end
    end
    return true
  end
  
  function have_staff_of_energy()
    for it in inventory() do
       if string.find(it.name(), "staff of energy") then
        return true
      end
    end
    return false
  end
  
  function on_corpses()
    for it in floor_items() do
      if string.find(it.name(), "corpse") then
        return true
      else
        return false
      end
    end
  end 

  function on_chunks()
    for it in floor_items() do
      if string.find(it.name(), "chunk") then
        return true
      else
        return false
      end
    end
  end

  function you_are_carnivore()
    return you.saprovorous()
  end
  
  function you_are_not_ghoul()
    return not (string.find(you.race(), "ghoul"))
  end

  function find_corpses()
    sendkeys(string.char(6) .. "@corpse&&!!rott&&!!skel&&!!sky&&!!vampire&&!!corpse rot" .. "\ra\r")
  end

  function inventory()
    return iter.invent_iterator:new(items.inventory())
  end

  function floor_items()
    return iter.invent_iterator:new(you.floor_items())
  end
  
  function staff_of_energy_is_equipped()
    local weapon =  items.equipped_at("Weapon")
    if weapon then
      return string.find(weapon.name(), "staff of energy")
    else
      return false
    end
  end
  
  -- Returns a table where the key is the monster description and value is the total number of that mob in your vision
  function getMonsterList()
    local monsters = {}
    for x = -8,8 do
      for y = -8,8 do
        m = monster.get_monster_at(x, y)
        local attitude_hostile = 0
        if m and (m:attitude() == attitude_hostile) and not (m:is_firewood()) then
          desc = m:desc()
          if (monsters[desc] == nil) then
            monsters[desc] = 1
          else
            monsters[desc] = monsters[desc] + 1
          end
        end
      end
    end
    return monsters   
  end

  --Escapes the special characters in a string for pattern matching
  function escape(str)
    --Escapes parens and dash "()-"
    local escaped = str:gsub('[%(%)%-]','%\%1')
    --Removes any coloration parts of the string
    return (escaped:gsub('<[^<]*>',''))
  end
  
  local function init_spells()
		local spell_list = {}
		
		for _, spell_name in ipairs(you.spells()) do
			spell_list[spell_name] = true
		end
	
		return spell_list
	end

	known_spells = init_spells()	
>

##################
# Mob Warnings   #
# orig. ScarletJ #
##################

< 
  -- Uses the getMonsterList and escape functions above
  function SpoilerAlert()
    local mobwarnings = {}
    --Add dangerous monsters to this table by using their name as the key, (as a lua pattern)
    --Set the value to the warning string you want to display, where it will formatted like:
    --"[The] Monster_Name Warning_Message"
    --If the Monster_Name includes a capital letter, the message will be prepended with [The] 
    
    local xl = you.xl()
    local no_rP = you.res_poison() == 0
    local no_rF = you.res_fire() == 0
    local no_rC = you.res_cold() == 0
    local no_rN = you.res_draining() == 0
    local no_rE = you.res_shock() == 0
    local no_Cons = not you.conservation()
    local no_Sustab = you.res_statdrain() == 0
    local no_rMut = you.res_mutation() == 0
    local you_are_flying = you.flying()
    local no_see_invis = not you.see_invisible()
    local no_rCorr = not you.res_corr()    
    local race = you.race()
    local form = you.transform()
    --local demonspawn_cons_scroll = you.mutation("conserve scroll")
    local you_are_undead = (race:find("ghoul") or race:find("vampire") or race:find("mummy") or form:find("lich"))
    
    --crawl.mpr(string.format("you.res_mutation() is: %s", you.res_mutation()))
    --crawl.mpr(string.format("no_rMut is: %s", no_rMut and "True" or "False"))
    
    if xl < 3 then
      if no_rP then
        mobwarnings["giant mite"] = "can poison!"
      end
     
      mobwarnings["ball python"] = "can constrict!"
      mobwarnings["giant cockroach"] = "is fast!"
      mobwarnings["giant gecko"] = "is fast!"
      mobwarnings["jackal"] = "is fast!"
    end
    
    if xl < 5 then
      if no_rP then
        mobwarnings["adder"] = "is fast and can poison!"
        mobwarnings["scorpion"] = "can poison!"
      end
      
      mobwarnings["worm"] = "can hit for moderate damage in melee!"
    end
    
    if xl < 9 then
      if no_rP then
        mobwarnings["worker ant"] = "is fast and can poison!"
      end
      if no_see_invis then
        if no_rP then
          mobwarnings["Natasha"] = "can cast Slow, Mephitic Cloud, Call Imp, and go Invisible!"
        else
          mobwarnings["Natasha"] = "can cast Slow, Call Imp, and go Invisible!"
        end
        if no_Cons then
          if no_rF and no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, go Invisible, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, Throw Flame, go Invisible, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, Throw Frost, go Invisible, or destroy your potions or scrolls!"
          elseif no_rF then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, go Invisible, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Flame, go Invisible, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, go Invisible, or destroy your potions or scrolls!"
          elseif no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, go Invisible, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, go Invisible, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Frost, go Invisible, or destroy your potions or scrolls!"
          else
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, go Invisible, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Flame, go Invisible, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, go Invisible, or destroy your potions or scrolls!"
          end
        else
          if no_rF and no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, and go Invisible!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, Throw Flame, and go Invisible!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, Throw Frost, or go Invisible!"
          elseif no_rF then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, and go Invisible!"
            mobwarnings["Blork"] = "can cast Haste, Throw Flame, and go Invisible!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, or go Invisible!"
          elseif no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, and go Invisible!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, and go Invisible!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Frost, or go Invisible!"
          else
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, and go Invisible!"
            mobwarnings["Blork"] = "can cast Haste and go Invisible!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, or go Invisible!"
          end
        end
      else
        if no_rP then
          mobwarnings["Natasha"] = "can cast Slow, Mephitic Cloud, and Call Imp!"
        else
          mobwarnings["Natasha"] = "can cast Slow and Call Imp!"
        end
        if no_Cons then
          if no_rF and no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, Throw Flame, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, Throw Frost, or destroy your potions or scrolls!"
          elseif no_rF then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Flame, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, or destroy your potions or scrolls!"
          elseif no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Frost, or destroy your potions or scrolls!"
          else
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, Throw Flame, and burn your scrolls!"
            mobwarnings["Blork"] = "can cast Haste, Throw Flame, break your potions, and burn your scrolls!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, or destroy your potions or scrolls!"
          end
        else
          if no_rF and no_rC then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, and Throw Flame!"
            mobwarnings["Blork"] = "can cast Haste, Throw Frost, and Throw Flame!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, Throw Flame, or Throw Frost!"
          elseif no_rF then
            mobwarnings["Sigmund"] = "can cast Slow, Confuse, and Throw Flame!"
            mobwarnings["Blork"] = "can cast Haste, and Throw Flame!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, or Throw Flame!"
          elseif no_rC then
            mobwarnings["Sigmund"] = "can cast Slow and Confuse!"
            mobwarnings["Blork"] = "can cast Haste and Throw Frost!"
            mobwarnings["orc wizard"] = "might cast Slow, Confuse, or Throw Frost!"
          else
            mobwarnings["Sigmund"] = "can cast Slow and Confuse!"
            mobwarnings["Blork"] = "can cast Haste!"
            mobwarnings["orc wizard"] = "might cast Slow or Confuse!"
          end
        end
      end
    
      mobwarnings["phantom"] = "can hit for moderate damage in melee and blinks!"
      mobwarnings["mummy"] = "can hit for moderate damage in melee!"
      mobwarnings["ogre"] = "can hit for high damage in melee!"
      mobwarnings["gnoll"] = "can hit for moderate damage in melee, and throws nets!"
      mobwarnings["Eustachio"] = "can summon minor creatures and blink!"
      mobwarnings["Crazy Yiuf"] = "can hit for high damage!"
      mobwarnings["Duvessa"] = "can hit for moderate damage in melee, and goes Berserk when Dowan dies!"
      mobwarnings["Dowan"] = "can Haste Duvessa, and will become Hasted and cast Throw Icicle when Duvessa dies!"
      mobwarnings["Ijyb"] = "will often zap you with wands!"
      mobwarnings["big kobold"] = "will probably throw things at you!"
    end
    
    if xl < 14 then
      if no_rN then
        mobwarnings["wight"] = "can drain you in melee!"
        mobwarnings["shadow imp"] = "can cast Pain and Animate Dead!"
        mobwarnings["Grinder"] = "can cast Paralyse and Pain!"
      else
        mobwarnings["wight"] = "can hit for moderate damage!"
        mobwarnings["shadow imp"] = "can Animate Dead!"
        mobwarnings["Grinder"] = "can cast Paralyse!"
      end
      if no_rC then
        if no_Cons then
          mobwarnings["white imp"] = "can cast Throw Frost and break your potions!"
          mobwarnings["ice beast"] = "can hit for moderate damage in melee, and break your potions!"
          mobwarnings["simulacr"] = "can do high damage in melee and break your potions!"
          mobwarnings["white ugly thing"] = "is fast and can break your potions!"
        else
          mobwarnings["white imp"] = "can cast Throw Frost!"
          mobwarnings["ice beast"] = "can hit for moderate damage in melee!"
          mobwarnings["simulacr"] = "can do high damage in melee!"
          mobwarnings["white ugly thing"] = "is fast and does cold damage!"
        end
      else
        if no_Cons then
          mobwarnings["white imp"] = "can break your potions!"
          mobwarnings["ice beast"] = "can break your potions!"
          mobwarnings["simulacr"] = "can break your potions!"
          mobwarnings["white ugly thing"] = "is fast and can break your potions!"
        else
          mobwarnings["simulacr"] = "can do moderate damage in melee!"
        end
      end
      if no_rF then
        if no_Cons then
          mobwarnings["fire drake"] = "can breathe blasts of flame and burn your scrolls!"
          mobwarnings["red ugly thing"] = "is fast and can burn your scrolls!"
          mobwarnings["steam dragon"] = "breathes balls of steam!"
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast Venom Bolt, IMB, Confuse, Slow, go Invisible, teleport away, and burn your scrolls in melee!"
          elseif no_rP then
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast Venom Bolt, IMB, Confuse, Slow, teleport away, and burn your scrolls in melee!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast IMB, Confuse, Slow, go Invisible, teleport away, and burn your scrolls in melee!"
          else
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast IMB, Confuse, Slow, teleport away, and burn your scrolls in melee!"
          end
        else
          mobwarnings["fire drake"] = "can breathe blasts of flame!"
          mobwarnings["steam dragon"] = "breathes balls of steam!"
          mobwarnings["red ugly thing"] = "is fast does fire damage!"
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast Venom Bolt, IMB, Confuse, Slow, go Invisible, and teleport away!"
          elseif no_rP then
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast Venom Bolt, IMB, Confuse, Slow, and teleport away!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast IMB, Confuse, Slow, go Invisible, and teleport away!"
          else
            mobwarnings["Erica"] = "can do moderate fire damage in melee, can cast IMB, Confuse, Slow, and teleport away!"
          end
        end
      else
        if no_Cons then
          mobwarnings["fire drake"] = "can burn your scrolls!"
          mobwarnings["red ugly thing"] = "is fast and can burn your scrolls!"
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, Confuse, Slow, go Invisible, teleport away, and burn your scrolls in melee!"
          elseif no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, Confuse, Slow, teleport away, and burn your scrolls in melee!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can cast IMB, Confuse, Slow, go Invisible, teleport away, and burn your scrolls in melee!"
          else
            mobwarnings["Erica"] = "can cast IMB, Confuse, Slow, teleport away, and burn your scrolls in melee!"
          end
        else
          mobwarnings["fire drake"] = "can breathe blasts of flame!"
          if no_rC or no_rF or no_rP then
            mobwarnings["Joseph"] = "shoots branded sling bullets!"
          end
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, Confuse, Slow, go Invisible, and teleport away!"
          elseif no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, Confuse, Slow, and teleport away!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can cast IMB, Confuse, Slow, go Invisible, and teleport away!"
          else
            mobwarnings["Erica"] = "can cast IMB, Confuse, Slow, and teleport away!"
          end
        end
      end
      if no_rP then
        mobwarnings["soldier ant"] = "is fast and can poison!"
        mobwarnings["water moccasin"] = "is fast and can poison!"
        mobwarnings["killer bee"] = "is very fast and can poison!"
        mobwarnings["black mamba"] = "is very fast and can hit for high damage in melee, and can poison!"
        mobwarnings["spiny frog"] = "is fast and can hit for high damage in melee, and can poison!"
        mobwarnings["queen ant"] = "can berserk other ants, and can poison!"
        mobwarnings["naga"] = "can constrict and spit poison!"
        mobwarnings["redback"] = "is fast and can poison!"
        mobwarnings["swamp drake"] = "breathes Mephitic clouds!"
        mobwarnings["green ugly thing"] = "is fast and can do high poison damage in melee!"
      else
        mobwarnings["soldier ant"] = "is fast!"
        mobwarnings["redback"] = "is fast!"
        mobwarnings["water moccasin"] = "is fast!"
        mobwarnings["killer bee"] = "is very fast!"
        mobwarnings["black mamba"] = "is very fast and can hit for high damage in melee!"
        mobwarnings["spiny frog"] = "is fast and can hit for high damage in melee!"
        mobwarnings["queen ant"] = "can berserk other ants!"
        mobwarnings["naga"] = "cand constrict!"
      end
      if no_rE then
        mobwarnings["electric eel"] = "can hit for high damage at range!"
        mobwarnings["cyan ugly thing"] = "is fast and can do high electric damage in melee!"
      end
      if no_rCorr then
        mobwarnings["jelly"] = "can corrode equipment in melee!"
      end
      mobwarnings["elephant"] = "can hit for high damage in melee, and can trample!"
      mobwarnings["Maud"] = "can hit for high damage in melee!"
      mobwarnings["warg"] = "is fast and can hit for moderate damage in melee!"
      mobwarnings["slave"] = "means Pikel is nearby!"
      mobwarnings["Pikel"] = "can hit for high damage in melee!"
      mobwarnings["draconian"] = "can hit for high damage in melee!"
      mobwarnings["gargoyle"] = "can cast Stone Arrow!"
      mobwarnings["blink frog"] = "is fast, can hit for moderate damage in melee, and blinks!"
      mobwarnings["wolf"] = "is very fast and can hit for moderate damage in melee!"
      mobwarnings["goliath beetle"] = "can hit for high damage in melee!"
      mobwarnings["wyvern"] = "is fast and can hit for high damage in melee!"
      mobwarnings["hippogriff"] = "can hit for high damage in melee!"
      mobwarnings["small abomination"] = "might be fast and can hit for high damage in melee!"
      mobwarnings["gnoll shaman"] = "can heal itself and can heal or Haste other gnolls!"
      mobwarnings["Prince Ribbit"] = "is fast and can hit for high damage in melee!"
      mobwarnings["orc warrior"] = "can hit for high damage!"
      mobwarnings["hill giant"] = "can hit for high damage in melee!"
      mobwarnings["troll"] = "can hit for high damage in melee, and regenerates quickly!"
      mobwarnings["Psyche"] = "might banish you in melee!"
      mobwarnings["two-headed ogre"] = "can hit for high damage in melee!"
      mobwarnings["raven"] = "is very fast and can hit for moderate damage in melee!"
      mobwarnings["yak"] = "can hit for moderate damage in melee!"
      mobwarnings["centaur"] = "is fast and can hit for moderate damage at range!"
      mobwarnings["slime creature"] = "can hit for high damage in melee!"
      mobwarnings["wraith"] = "can slow you in melee!"
    end
    
    if you.xl() < 21 then
      local tenguconjwarn = ""
      local orcsorcwarn = ""
      if no_rF then
        if no_Cons then
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, go Invisible, teleport away, and burn your scrolls in melee!"
          elseif no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, teleport away, and burn your scrolls in melee!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can cast IMB, go Invisible, teleport away, and burn your scrolls in melee!"
          else
            mobwarnings["Erica"] = "can cast IMB, teleport away, and burn your scrolls in melee!"
          end
          mobwarnings["deep elf mage"] = "can cast fireball and slow, and burn your scrolls!"
          mobwarnings["salamander"] = "does fire damage and burn your scrolls!"
          mobwarnings["efreet"] = "can cast Bolt of Fire, Fireball, and burn your scrolls!"
          mobwarnings["Harold"] = "can throw nets, cast Bolt of Fire, and burn your scrolls!"
          mobwarnings["lindwurm"] = "has a nasty fire breath attack and burn your scrolls!"
          mobwarnings["fire drake"] = "can burn your scrolls!"
          tenguconjwarn = tenguconjwarn  .. ", Bolt of Magma and burn your scrolls"
          orcsorcwarn = orcsorcwarn .. ", Bolt of Fire and burn your scrolls"
        else
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, go Invisible, and teleport away!"
          elseif no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, and teleport away!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can cast IMB, go Invisible, and teleport away!"
          else
            mobwarnings["Erica"] = "can cast IMB and teleport away!"
          end
          mobwarnings["Harold"] = "can throw nets and cast Bolt of Fire!"
          mobwarnings["deep elf mage"] = "can cast Fireball and Slow!"
          mobwarnings["salamander"] = "uses fire branded attacks!"
          mobwarnings["efreet"] = "can cast Bolt of Fire and Fireball!"
          mobwarnings["lindwurm"] = "has a nasty fire breath attack!"
          tenguconjwarn = tenguconjwarn  .. ", Bolt of Magma"
          orcsorcwarn = orcsorcwarn .. ", Bolt of Fire"
        end
      else
        if no_Cons then
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, go Invisible, teleport away, and burn your scrolls in melee!"
          elseif no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, teleport away, and burn your scrolls in melee!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can cast IMB, go Invisible, teleport away, and burn your scrolls in melee!"
          else
            mobwarnings["Erica"] = "can cast IMB, teleport away, and burn your scrolls in melee!"
          end
          mobwarnings["Harold"] = "can throw nets and burn your scrolls!"
          mobwarnings["deep elf mage"] = "can cast slow and burn your scrolls!"
          mobwarnings["salamander"] = "can burn your scrolls!"
          mobwarnings["efreet"] = "can burn your scrolls!"
          mobwarnings["lindwurm"] = "can burn your scrolls!"
          mobwarnings["fire drake"] = "can burn your scrolls!"
        else
          if no_see_invis and no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, go Invisible, and teleport away!"
          elseif no_rP then
            mobwarnings["Erica"] = "can cast Venom Bolt, IMB, and teleport away!"
          elseif no_see_invis then
            mobwarnings["Erica"] = "can cast IMB, go Invisible, and teleport away!"
          else
            mobwarnings["Erica"] = "can cast IMB and teleport away!"
          end
          mobwarnings["Harold"] = "can throw nets!"
          mobwarnings["deep elf mage"] = "can cast slow!"
          mobwarnings["lindwurm"] = "can do high damage in melee!"
        end
      end
      if no_rP then
        mobwarnings["wolf spider"] = "is fast and can hit for high damage in melee, and can poison!"
        mobwarnings["naga warrior"] = "can constrict you and hit for high damage in melee, and spits poison!"
        mobwarnings["naga mage"] = "can cast IMB and Poison Arrow, and spits poison!"
        mobwarnings["naga ritualist"] = "can give poison vulnerability, and do poison damage over time with toxic radiance!"
        mobwarnings["redback"] = "is fast and can poison!"
        mobwarnings["Sonja"] = "shoots Curare needles and will probably banish you in melee!"
        tenguconjwarn = tenguconjwarn  .. ", Venom Bolt"
      else
        mobwarnings["naga warrior"] = "can constrict you and hit for high damage in melee, and spits poison!"
        mobwarnings["naga mage"] = "can cast IMB and Poison Arrow!"
        mobwarnings["wolf spider"] = "is fast and can hit for high damage in melee!"
        mobwarnings["naga ritualist"] = "can remove poison resistance, and do damage over time with toxic radiance!"
        mobwarnings["Sonja"] = "will probably banish you in melee!"
      end
      if no_rE then
        tenguconjwarn = tenguconjwarn  .. ", Lightning Bolt"
        mobwarnings["raiju"] = "is fast and can Lightning Bolt itself at you!"
      else
        mobwarnings["raiju"] = "is fast and blinks around!"
      end
      if no_rC then
        if no_Cons then
          mobwarnings["bog body"] = "can cast Slow, Bolt of Cold, and break your potions!"
          mobwarnings["Fannar"] = "can cast Bolt of Cold, Ozo's Refrigeration, Summon Ice Beast, Blink, and break your potions!"
          mobwarnings["simulacr"] = "can do high damage in melee and break your potions!"
          mobwarnings["freezing wraith"] = "can do high cold damage and slow you in melee, and break your potions!"
        else
          mobwarnings["bog body"] = "can cast Slow and Bolt of Cold!"
          mobwarnings["Fannar"] = "can cast Bolt of Cold, Ozo's Refrigeration, Summon Ice Beast, and Blink!"
          mobwarnings["simulacr"] = "can do high damage in melee!"
          mobwarnings["freezing wraith"] = "can do high cold damage and slow you in melee,!"
        end
      else
        if no_Cons then
          mobwarnings["bog body"] = "can cast Slow, and break your potions!"
          mobwarnings["Fannar"] = "can Blink, Summon Ice Beasts, and break your potions!"
          mobwarnings["simulacr"] = "can break your potions!"
          mobwarnings["freezing wraith"] = "can slow you in melee, and break your potions!"
        else
          mobwarnings["bog body"] = "can cast Slow!"
          mobwarnings["Fannar"] = "can Blink and Summon Ice Beasts!"
          mobwarnings["freezing wraith"] = "can slow you in melee!"
        end
      end
      if no_rN then
        orcsorcwarn = orcsorcwarn .. ", Bolt of Draining"
        mobwarnings["Nergalle"] = "can cast Bolt of Draining, Summon Spectral Orcs, Haste Other, and Death's Door!"
        if you_are_undead then
          mobwarnings["Josephine"] = "can cast Ghostly Fireball, Vampiric Draining, Animate Dead, and Dispel Undead!"
        else
          mobwarnings["Josephine"] = "can cast Ghostly Fireball, Vampiric Draining, and Animate Dead!"
        end
      else
        mobwarnings["Nergalle"] = "can Summon Spectral Orcs, cast Haste Other, and Death's Door!"
        if you_are_undead then
          mobwarnings["Josephine"] = "can cast Animate Dead, and Dispel Undead!"
        else
          mobwarnings["Josephine"] = "can cast Animate Dead!"
        end
      end
      if no_rCorr then
        mobwarnings["brown ugly thing"] = "is fast and can cause corrosion in melee!"
        mobwarnings["brown very ugly thing"] = "is fast and can cause corrosion in melee!"
        mobwarnings["oklob"] = "can corrode equipment at range!"
      else
        mobwarnings["brown ugly thing"] = "is fast!"
        mobwarnings["brown very ugly thing"] = "is fast!"
      end
      
      mobwarnings["spriggan"] = "is very fast and can hit for moderate damage!"
      mobwarnings["firefly"] = "is very fast, can hit for moderate damage, and flashes a warning beacon!"
      mobwarnings["komodo dragon"] = "can hit for high damage and cause sickness in melee!"
      mobwarnings["purple ugly thing"] = "is fast and can cause sickness in melee!"
      mobwarnings["tengu conjurer"] = "is fast and can cast Force Lance, IMB"..tenguconjwarn.."!"
      mobwarnings["orc sorcerer"] = "can cast Paralyse, Summon Demon, Animate Dead"..orcsorcwarn.."!"
      mobwarnings["Snorg"] = "can berserk and hit for high damage!"
      mobwarnings["manticore"] = "can hit for high damage at range, and Barbs causes damage when you move!"
      mobwarnings["large abomination"] = "might be fast and can hit for high damage in melee!"
      mobwarnings["harpy"] = "is very fast and can hit for high damage in melee!"
      mobwarnings["anaconda"] = "is very fast and can constrict you!"
      mobwarnings["Kirke"] = "can summon Monstrous Menageries, go invisible, turn you into a pig, and deflects missiles!"
      mobwarnings["thorn lotus"] = "can hit for high damage at range!"
      mobwarnings["tengu warrior"] = "is fast and can hit for high damage in melee!"
      mobwarnings["kobold demonologist"] = "can summon minor demons!"
      mobwarnings["death yak"] = "can hit for high damage in melee!"
      mobwarnings["centaur warrior"] = "can hit for high damage at range!"
      mobwarnings["skeletal warrior "] = "can hit for high damage in melee!"
      mobwarnings["large slime creature"] = "can hit for high damage in melee!"
      mobwarnings["enormous slime creature"] = "can hit for high damage in melee!"
      mobwarnings["hydra"] = "can hit for high damage in melee!"
      mobwarnings["dire elephant"] = "can hit for high damage in melee, and can trample!"
      mobwarnings["tarantella"] = "is fast and can cause confusion in melee!"
      mobwarnings["orc knight"] = "can hit for high damage!"
      mobwarnings["naga sharpshooter"] = "can shoot you with portal projectiles!"
      mobwarnings["cyclops"] = "can throw large rocks!"
      mobwarnings["Maurice"] = "can steal items, go invisible, and teleport away!"
      mobwarnings["Erolcha"] = "might cast banishment, paralyse, or LCS!"
    end
    if you.xl() < 27 then 
      local tengureaverwarn = ""
      if no_rF then
        if no_Cons then
          mobwarnings["salamander firebrand"] = "is fast and melee attacks will surround you with flame clouds and burn your scrolls!"
          mobwarnings["salamander mystic"] = "can haste allies, and casts Bolt of Magma, IMB, and burn your scrolls!"
          mobwarnings["red very ugly thing"] = "is fast, can cause sticky flames in melee, and burn your scrolls!"
          mobwarnings["flaming corpse"] = "is fast and can cause sticky flames in melee and annihilate your scrolls!"
          mobwarnings["mottled draconian"] = "can spit sticky flames at range and annihilate your scrolls!"
          mobwarnings["fire dragon"] = "has a nasty fire breath attack and burn your scrolls!"
          mobwarnings["fire giant"] = "can cast Fireball, Bolt of Fire, and burn your scrolls!"
          tengureaverwarn = tengureaverwarn .. ", can cast Bolt of Magma, Fireball, and burn your scrolls"
        else
          mobwarnings["salamander firebrand"] = "is fast and melee attacks will surround you with flame clouds!"
          mobwarnings["salamander mystic"] = "can haste allies, and casts Bolt of Magma and IMB!"
          mobwarnings["red very ugly thing"] = "is fast, can cause sticky flames in melee!"
          mobwarnings["flaming corpse"] = "is fast, can cause sticky flames in melee!"
          mobwarnings["mottled draconian"] = "can spit sticky flames at range!"
          mobwarnings["fire dragon"] = "has a nasty fire breath attack!"
          mobwarnings["fire giant"] = "can cast Fireball and Bolt of Fire!"
          tengureaverwarn = tengureaverwarn .. ", can cast Bolt of Magma, Fireball"
        end
      else
        if no_Cons then
          mobwarnings["salamander firebrand"] = "is fast and melee attacks will surround you with flame clouds and burn your scrolls!"
          mobwarnings["salamander mystic"] = "can haste allies, and casts IMB and and burn your scrolls!"
          mobwarnings["red very ugly thing"] = "is fast, can cause sticky flames in melee, and burn your scrolls!"
          mobwarnings["flaming corpse"] = "is fast, can cause sticky flames in melee, and annihilate your scrolls!"
          mobwarnings["mottled draconian"] = "can spit sticky flames at range, and annihilate your scrolls!"
          mobwarnings["fire dragon"] = "can burn your scrolls!"
          mobwarnings["fire giant"] = "can burn your scrolls!"
          tengureaverwarn = tengureaverwarn .. ", can burn your scrolls"
        else
          mobwarnings["salamander mystic"] = "can haste allies and casts IMB!"
          mobwarnings["salamander firebrand"] = "is fast and melee attacks will surround you with flame clouds!"
          mobwarnings["red very ugly thing"] = "is fast!"
          mobwarnings["flaming corpse"] = "is fast!"
          mobwarnings["fire dragon"] = "can do high damage in melee!"
          mobwarnings["fire giant"] = "can do high damage in melee!"
        end
      end
      if no_rC then
        if no_Cons then
          tengureaverwarn = tengureaverwarn .. ", can cast Freezing Cloud, can break your potions"
          mobwarnings["frost giant"] = "can cast Bolt of Cold, and breaks your potions!"
          mobwarnings["ice dragon"] = "has a nasty cold breath attack, and break your potions!"
        else
          tengureaverwarn = tengureaverwarn .. ", can cast Freezing Cloud"
          mobwarnings["frost giant"] = "can cast Bolt of Cold!"
          mobwarnings["ice dragon"] = "has a nasty cold breath attack!"
        end
      else
        if no_Cons then
          tengureaverwarn = tengureaverwarn .. ", can break your potions"
          mobwarnings["frost giant"] = "can do high damage in melee and breaks your potions!"
          mobwarnings["ice dragon"] = "can do high damage in melee and break your potions!"
        else
          mobwarnings["frost giant"] = "can do high damage in melee!"
          mobwarnings["ice dragon"] = "can do high damage in melee!"
        end
      end
      if no_rN then
        mobwarnings["eidolon"] = "can cast Bolt of Draining and Fear!"
      else
        mobwarnings["eidolon"] = "can cast Fear!"
      end
      if no_rE then
        tengureaverwarn = tengureaverwarn .. ", can cast Lightning Bolt"
      end
      if no_rP then
        mobwarnings["greater naga"] = "is strong in melee, and casts Venom Bolt, Poison Arrow, IMB, and spits poison!"
        mobwarnings["Aizul"] = "is very fast and casts Sleep, Poison Arrow, and Venom Bolt!"
      else
        mobwarnings["greater naga"] = "is strong in melee, and can cast Poison Arrow and IMB!"
        mobwarnings["Aizul"] = "is very fast and casts Sleep and Poison Arrow!"
      end
      if no_see_invis then
        mobwarnings["wizard"] = "might cast banishment, paralyse, LCS, or go Invisible!"
        if no_rN then
          if no_rC or no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Fire, Bolt of Cold, go Invisible, and destroy potions or scrolls!"
          elseif no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Fire, go Invisible, and destroy potions or scrolls!"
          elseif no_rF then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Fire, or go Invisible!"
          elseif no_rC and no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Cold, go Invisible and destroy potions or scrolls!"
          elseif no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, go Invisible, and destroy potions or scrolls!"
          else
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, or go Invisible!"
          end
        else
          if no_rC or no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Fire, Bolt of Cold, go Invisible, and destroy potions or scrolls!"
          elseif no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Fire, go Invisible, and destroy potions or scrolls!"
          elseif no_rF then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Fire, or go Invisible!"
          elseif no_rC and no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Cold, go Invisible and destroy potions or scrolls!"
          elseif no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, go Invisible, and destroy potions or scrolls!"
          else
            mobwarnings["necromancer"] = "can cast Animate Dead, or go Invisible!"
          end
        end
      else
        mobwarnings["wizard"] = "might cast banishment, paralyse, or LCS!"
        if no_rN then
          if no_rC or no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Fire, Bolt of Cold, and destroy potions or scrolls!"
          elseif no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Fire, and destroy potions or scrolls!"
          elseif no_rF then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, or Bolt of Fire!"
          elseif no_rC and no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, Bolt of Cold, and destroy potions or scrolls!"
          elseif no_Cons then
            mobwarnings["necromancer"] = "can cast Agony, Animate Dead, and destroy potions or scrolls!"
          else
            mobwarnings["necromancer"] = "can cast Agony and Animate Dead!"
          end
        else
          if no_rC or no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Fire, Bolt of Cold, and destroy potions or scrolls!"
          elseif no_rF and no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Fire, and destroy potions or scrolls!"
          elseif no_rF then
            mobwarnings["necromancer"] = "can cast Animate Dead, or Bolt of Fire!"
          elseif no_rC and no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, Bolt of Cold, and destroy potions or scrolls!"
          elseif no_Cons then
            mobwarnings["necromancer"] = "can cast Animate Dead, and destroy potions or scrolls!"
          else
            mobwarnings["necromancer"] = "can cast Animate Dead!"
          end
        end
      end
      
      mobwarnings["Lernaean hydra"] = "don't fight it in melee! Just don't!"
      mobwarnings["tengu reaver"] = "is fast"..tengureaverwarn.."!"
      mobwarnings["water nymph"] = "can create water, teleport to other water, and Waterstrike you!"
      mobwarnings["yaktaur"] = "can hit for high damage at range!"
      mobwarnings["Wiglaf"] = "can cast might and haste on himself!"
      mobwarnings["orc warlord"] = "can hit for high damage!"
      mobwarnings["minotaur"] = "can hit for very high damage!"
      mobwarnings["titanic slime creature"] = "can hit for high damage in melee!"
      mobwarnings["Rupert"] = "can paralyse you in fear!"
      mobwarnings["Vashnia"] = "can blink herself and allies away!"
      mobwarnings["great orb of eyes"] = "can cast paralyse, disintegrate, slow, confuse, and teleport you!"
      mobwarnings["vampire knight"] = "can cast paralyse!"
      mobwarnings["vampire mage"] = "can Summon Undead and Animate Dead!"
      mobwarnings["stone giant"] = "throws large rocks and can hit for very high damage!"
      mobwarnings["ettin"] = "can do very high damage in melee!"
      mobwarnings["Louise"] = "can cast banishment!"
      mobwarnings["purple very ugly thing"] = "is fast and can cause rotting in melee!"
      mobwarnings["deep troll earth mage"] = "can cast LRD and dig!"  
      mobwarnings["ogre mage"] = "might cast banishment, paralyse, or LCS!"
      mobwarnings["purple draconian"] = "can dispel your buffs!"
      mobwarnings["vault sentinel"] = "can mark you and blow a signal horn!"
      mobwarnings["vault warden"] = "can lockdown doors and staircases!"
      mobwarnings["ironheart preserver"] = "can absorb the damage of its allies and heal itself!"
    end
    
    if no_rP then
      mobwarnings["red wasp"] = "is very fast and can Paralyse and poison in melee!"
      mobwarnings["yellow wasp"] = "is very fast and can Paralyse, Slow, and poison in melee!"
    end
    
    if no_rF then
      if no_Cons then
        mobwarnings["fire crab"] = "has a flaming cloud breath attack which will annihilate your scrolls!"
        mobwarnings["fire giant"] = "can cast fireball and bolt of fire!"
        mobwarnings["fire dragon"] = "has a nasty fire breath attack!"
        mobwarnings["deep elf mage"] = "can cast fireball and slow!"
      else
        mobwarnings["fire giant"] = "can cast fireball and bolt of fire!"
        mobwarnings["fire dragon"] = "has a nasty fire breath attack!"
        mobwarnings["deep elf mage"] = "can cast fireball and slow!"
      end
    end
    
    if (no_rC or no_Cons) then
      if no_rCons then
        mobwarnings["octopode crusher"] = "can cast Throw Icicle, break your potions, and throw you in melee!"
      else
        mobwarnings["octopode crusher"] = "can cast Throw Icicle, break your potions, and throw you in melee!"
      end
      
      if no_Cons and no_rF then
        mobwarnings["merfolk aquamancer"] = "can cast Primal Wave, Steam Ball, Throw Icicle, Blink, and break your potions!"
      elseif no_Cons then
        mobwarnings["merfolk aquamancer"] = "can cast Primal Wave, Throw Icicle, Blink, and break your potions!"
      elseif no_rF then
        mobwarnings["merfolk aquamancer"] = "can cast Primal Wave, Steam Ball, Throw Icicle, and Blink!"
      else
        mobwarnings["merfolk aquamancer"] = "can cast Primal Wave, Throw Icicle, and Blink!"
      end
    end
    
    if no_rN then
      mobwarnings["shadow dragon"] = "has a nasty draining breath attack!"
    end

    local electricwarning = ""
    if no_rE then
      electricwarning = " <red>You are not wearing rElec!</red>"
    end
    mobwarnings["electric golem"] = "is fast, has electric attacks, and blinks!" .. electricwarning
    mobwarnings["Nikola"] = "casts Lightning Bolt, Chain Lightning and blinks!" .. electricwarning
    mobwarnings["storm dragon"] = "can do high damage in melee and has a nasty electric breath attack!" .. electricwarning
    mobwarnings["shock serpent"] = "is fast, casts Bolt of Lighning, does electric damage, and causes electric damage when injured!" .. electricwarning
    
    local statdrainwarning = ""
    if no_Sustab then
      statdrainwarning = ", or drain your Int"
      mobwarnings["brain worm"] = "can drain your Int!"
    end
    mobwarnings["Norris"] = "can cast paralyse and smite you"..statdrainwarning.."!"
    mobwarnings["orange crystal statue"] = "can cast confuse and Shadow Creatures"..statdrainwarning.."!"
    mobwarnings["neqoxec"] = "can mutate you"..statdrainwarning.."!"
    mobwarnings["giant orange brain"] = "can cast Shadow Creatures"..statdrainwarning.."!"
    
    local mutationwarning = ""
    if no_rMut then
      mutationwarning = ", and can mutate you"
      mobwarnings["cacodemon"] = "can mutate you!"
      mobwarnings["shining eye"] = "can mutate you!"
      mobwarnings["pulsating lump"] = "can mutate you in melee!"
    end
    mobwarnings["orb of fire"] = "can cast Fireball and Bolt of Fire"..mutationwarning.."!"
    
    local gdwarn = "can do high damage in melee"
    local alichwarn = ""
    if (no_rF or no_rP or no_rC or no_rN or no_Cons or no_see_invis) then
      
      if no_Cons then
        if no_rF and no_Cons then 
          gdwarn = gdwarn .. ", breathe Bolts of Fire and burn your scrolls"
          alichwarn = alichwarn .. ", cast Bolt of Fire and burn your scrolls"
        elseif no_rF then 
          gdwarn = gdwarn .. ", burn your scrolls"
          alichwarn = alichwarn .. ", burn your scrolls"
        elseif no_rF then 
          gdwarn = gdwarn .. ", breathe Bolts of Fire" 
          alichwarn = alichwarn .. ", cast Bolt of Fire" 
        end
        
        if no_rC and no_Cons then 
          gdwarn = gdwarn .. ", breathe Bolts of Cold and break your potions"
          alichwarn = alichwarn .. ", cast Bolt of Cold and break your potions"
        elseif no_Cons then 
          gdwarn = gdwarn .. ", break your potions"
          alichwarn = alichwarn .. ", break your potions"
        elseif no_rC then 
          gdwarn = gdwarn .. ", breathe freezing blasts" 
          alichwarn = alichwarn .. ", cast Bolt of Cold" 
        end
      else
        gdwarn = gdwarn .. ", burn your scrolls and break your potions" 
        alichwarn = alichwarn .. ", burn your scrolls and break your potions" 
      end
      
      if no_rN then 
        gdwarn = gdwarn .. ", breathe Bolts of Draining" 
        alichwarn = alichwarn .. ", cast Bolt of Draining" 
      end
      if no_rP then 
        gdwarn = gdwarn .. ", breathe poison clouds" 
      end
      if no_see_invis then
        alichwarn = alichwarn .. ", or go Invisible"
      end
      
    end
    mobwarnings["golden dragon"] = gdwarn .. "!"
    mobwarnings["lich"] = "might cast Banishment, Paralyse, Summon Demon, IOOD, or LCS!"
    mobwarnings["ancient lich"] = "might cast Banishment, Paralyse, SGD, IOOD, or LCS" .. alichwarn .. "!"
    
    if no_rF and no_cons then
      mobwarnings["Xtahua"] = "does high damage in melee, has a nasty fire breath attack, and can burn your scrolls!"
    elseif no_rF then
      mobwarnings["Xtahua"] = "does high damage in melee and has a nasty fire breath attack"
    elseif no_cons then
      mobwarnings["Xtahua"] = "does high damage in melee and can burn your scrolls!"
    else
      mobwarnings["Xtahua"] = "does high damage in melee!"
    end
    
    local flightwarning = ""
    if you_are_flying then
      flightwarning = "<red>You are in flight!</red>"
    end
    
    mobwarnings["air mage"] = "can cast Airstrike! "..flightwarning
    mobwarnings["titan"] = "can cast Lightning Bolt and Airstrike! "..flightwarning .. electricwarning
    mobwarnings["blizzard demon"] = "can cast Airstrike! "..flightwarning
    mobwarnings["wind drake"] = "can cast Airstrike! "..flightwarning
    mobwarnings["Gastronok"] = "can cast Airstrike! "..flightwarning
    mobwarnings["Sojobo"] = "is fast and can cast Airstrike! "..flightwarning
    
    if no_Cons then
      mobwarnings["mottled"] = "can cast sticky flames at range, annihilating your scrolls!"
      mobwarnings["white draconian"] = "can breathe chilling blasts, breaking your potions!"
      mobwarnings["Joseph"] = "shoots branded sling bullets which might destroy your potions or scrolls!"
      if no_see_invis then
        mobwarnings["orc wizard"] = "might go Invisible, or destroy your potions or scrolls!"
      else
        mobwarnings["orc wizard"] = "might destroy your potions or scrolls!"
      end
    end
    
    if no_see_invis then
      mobwarnings["boggart"] = "can cast Shadow Creatures and go Invisible!"
    else
      mobwarnings["boggart"] = "can cast Shadow Creatures!"
    end
    
    if no_rCorr then
      mobwarnings["yellow draconian"] = "can corrode your equipment at range!"
    end
    
    if no_rP and no_rE then
      mobwarnings["draconian annihilator"] = "can cast LCS, Poison Arrow, Lightning Bolt, and Iron Shot!"
    elseif no_rP then 
      mobwarnings["draconian annihilator"] = "can cast LCS, Poison Arrow, and Iron Shot!"
    elseif no_rE then
      mobwarnings["draconian annihilator"] = "can cast LCS, Lightning Bolt, and Iron Shot!"
    else  
      mobwarnings["draconian annihilator"] = "can cast Lehudib's Crystal Spear or Iron Shot!"
    end
    
    mobwarnings["rakshasa"] = "can cast IMB, Phantom Mirror, duplicating itself and allies, and blinks!"    
    mobwarnings["phantasmal warrior"] = "can bypass armour and shields, and lowers MR!"
    mobwarnings["giant eyeball"] = "can paralyse you!"
    mobwarnings["mana viper"] = "is fast and has an antimagic bite!"
    mobwarnings["golden eyeball"] = "can confuse you!"
    mobwarnings["spriggan druid"] = "is very fast, can awaken trees, recall animals, and cast Stone Arrow!"
    mobwarnings["thorn hunter"] = "can throw a nasty volley of thorns, and create brambles!"
    mobwarnings["apocalypse crab"] = "is fast and has a chaos cloud breath attack!"
    mobwarnings["tentacled monstrosity"] = "has dangerous constriction in melee!"
    mobwarnings["jumping spider"] = "is fast and can ensnare you in webs!"
    mobwarnings["Arachne"] = "can ensnare you in her webs!"
    mobwarnings["Enchantress"] = "is very fast and can cast Dimension Anchor, Slow, Haste, Mass Confusion, and Strip Resistance!"
    mobwarnings["deep elf demonologist"] = "can cast banishment or summon Greater Demons!"
    mobwarnings["draconian caller"] = "can summon Dragons and Death Drakes!"
    mobwarnings["draconian zealot"] = "can cast smite-targeted Hellfire or smite you!"
    mobwarnings["deep elf annihilator"] = "can cast Lehudib's Crystal Spear or Iron Shot!"
    mobwarnings["blood saint"] = "can cast LCS and other Legendary Destruction!"
    mobwarnings["black sun"] = "can give allies a dangerous black mark which gives melee effects!"
    mobwarnings["corrupter"] = "can summon allies from various branches!"
    mobwarnings["moth of wrath"] = "is fast and can enrage both enemies and you!"
    mobwarnings["orb spider"] = "is fast and can cast Orb of Destruction!"
    mobwarnings["deep troll shaman"] = "can cast haste and might on allies!"
    mobwarnings["warmonger"] = "can sap your magic and summon a grand avatar!"
    mobwarnings["chaos champion"] = "can dispel buffs, entrap you, and other chaotic effects!"
    mobwarnings["draconian shifter"] = "can block teleports, blink allies encircling you, or cause you to blink!"
    mobwarnings["guardian serpent"] = "can blink allies encircling you!"
    mobwarnings["Roxanne"] = "can cast LCS and Iron Shot at you, or shift your position!"
    mobwarnings["draconian scorcher"] = "can cast smite-targeted Hellfire!"
    mobwarnings["hellion"] = "can cast smite-targeted Hellfire!"
    mobwarnings["Azrael"] = "can cast smite-targeted Hellfire!"
    mobwarnings["deep elf sorcerer"] = "can cast banishment or line-of-sight Hellfire!"
    mobwarnings["quicksilver dragon"] = "can dispel your buffs!"
    mobwarnings["ironbrand convoker"] = "can recall allies and cast might on them!"
    mobwarnings["Hell Sentinel"] = "can cast line-of-sight Hellfire and Iron Shot!"
    mobwarnings["Asmodeus"] = "can cast line-of-sight Hellfire and Summon Greater Demons!"
    mobwarnings["flayed ghost"] = "can Flay you to shreds!"
    mobwarnings["Ice Fiend"] = "can cast Torment!"
    mobwarnings["Shadow Fiend"] = "can cast Torment and Dispel Undead!"
    mobwarnings["curse skull"] = "can cast Torment and Summon Undead!"
    mobwarnings["tormentor"] = "can cast Torment!"
    mobwarnings["curse toe"] = "can cast Torment and Summon Fungus!"
    mobwarnings["Menkaure"] = "can cast Torment!"
    mobwarnings["Gloorx Vloq"] = "can cast Torment!"
    mobwarnings["Ereshkigal"] = "can cast Torment and paralyse!"
    mobwarnings["Brimstone Fiend"] = "can cast Torment and line-of-sight Hellfire!"
    mobwarnings["daeva"] = "can smite you!"
    mobwarnings["balrug"] = "can smite you, and cast fireball!"
    mobwarnings["smoke demon"] = "can smite you, and cast ranged sticky flame!"
    mobwarnings["deep elf priest"] = "can smite you!"
    mobwarnings["orc priest"] = "can smite you!"
    mobwarnings["orc high priest"] = "can smite you!"
    mobwarnings["starcursed mass"] = "can smite you!"
    mobwarnings["Frances"] = "can smite you!"
    mobwarnings["Mnoleg"] = "cast Summon Eyes and smite you!"
    mobwarnings["deep elf high priest"] = "can cast smite-targeted Hellfire or smite you!"
    mobwarnings["mummy priest"] = "can cast Torment and smite you!"
    mobwarnings["greater mummy"] = "can cast Torment and smite you!"
    mobwarnings["Khufu"] = "can cast Torment and smite you!"
    mobwarnings["sphinx"] = "can cast paralyse, slow, confuse, and smite you!"
    mobwarnings["catoblepas"] = "can petrify you with its breath!"
    mobwarnings["Jorgrun"] = "can cast petrify and shatter!"
    mobwarnings["Jory"] = "can mesmerise, cast LCS and blink close!"
    mobwarnings["Cerebov"] = "can cast Fire Storm, Iron Shot, and Summon Greater Demons!"
    mobwarnings["Mennas"] = "can cast silence and confuse!"
    mobwarnings["Ignacio"] = "can cast Agony!"
    mobwarnings["shadow demon"] = "can cast Shadow Creatures!"
    mobwarnings["ynoxinul"] = "can cast Iron Shot!"
    mobwarnings["Frederick"] = "can cast Iron Shot!"
    mobwarnings["Dispater"] = "can cast line-of-sight Hellfire, Iron Shot, and summon Greater Demons!"
    mobwarnings["ghost moth"] = "will drain your Magic!"
    mobwarnings["eye of draining"] = "will drain your Magic!"
  
    -- Holds the overall alert message and count of dangers 
    local alerts = ""
    local short_alert = " "
    local total_dangers = 0
    -- For each type of monster you can see, using getMonsterList()
    -- This goes through each monster in the mobwarnings table above and
    -- Checks to see if it matches the description of each mob in sight
    -- Excluding forms that can't cast: zombie, skeleton, simulcrum, but not incapacited forms
    for mons, count in pairs(getMonsterList()) do  
      for mob, message in pairs(mobwarnings) do
        if string.find(mons, mob) 
        and not string.find(mons, "zombie")
        and not string.find(mons, "skeleton")
        and not string.find(mons, "shaped block of ice")
        and not string.find(mons, "spectral")
        and not (string.find(mons, "simulacr") and mob ~= "simulacr")
        and not (string.find(mons, "orc") and mob == "wizard") 
        and not (string.find(mons, "ancient lich") and mob == "lich")
        and not (string.find(mons, "death yak") and mob == "yak")
        and not (string.find(mons, "gnoll shaman") and mob == "gnoll")
        and not (string.find(mons, "gnoll captain") and mob == "gnoll")
        and not (string.find(mons, "mottled draconian") and mob == "mottled")
        and not (string.find(mons, "dire elephant") and mob == "elephant")
        and not (string.find(mons, "salamander mystic") and mob == "salamander")
        and not (string.find(mons, "Josephine") and mob == "Joseph") then
          --Used to format the string for Unique/Named mobs
          local is_fiend = (string.find(mons, "Fiend") ~= nil)
          local is_uppercase = (string.find(mons, "%u") ~= nil)
          local is_unique = is_uppercase and not is_fiend
          --Holds this mobs alert message
          local alert = ""
          local mob_name = ""
          --Formatting for uniques
          if is_unique then
            alert = "<cyan>" .. mons .. "</cyan> " .. message
            mob_name = mons
          --For more than 1 of the same monster
          elseif (count > 1) then
            alert = "The <cyan>".. mons .. "</cyan> " .. message .. " x" .. count
            mob_name = mons .. " x" .. count 
          --For a single non-unique monster
          else
            alert = "The <cyan>" .. mons .. "</cyan> " .. message
            mob_name = mons
          end
          --Keeps a count of all the found matches
          total_dangers = total_dangers + count
          --Adds the created alert string to the full string of alerts
          alerts = alerts .. " " .. alert
          short_alert = short_alert .. mob_name .. ", " 
        end
      end
    end
    
    short_alert = string.sub(short_alert, 1, -3) .. "!"
    
    --If there is an alert and it was not displayed in the last six messages then display the warning
    if not ((alerts == "") 
    or string.find(crawl.messages(6), escape(alerts))) then
      --For a single monster
      if total_dangers == 1 then
        crawl.mpr("<lightgrey>Spoiler Alert:" .. alerts .. "</lightgrey>")
      --For 2 or 3
      elseif total_dangers < 4 then
        crawl.mpr("<yellow>Warning x"..total_dangers .. ":" .. alerts .. "</yellow>")
      --For 4 to 7
      elseif total_dangers < 8 and (not string.find(crawl.messages(6), escape(short_alert))) then
        crawl.mpr("<lightred>Danger x" ..total_dangers .. ":" .. short_alert .. "</lightred>")
      --For 8 or more
      elseif not string.find(crawl.messages(6), escape(short_alert)) then
        crawl.mpr("<red>PANIC x" ..total_dangers .. ":" .. short_alert .. "</red>")
      end
    end
  end
>

###############
# Damage Calc #
###############
<
  local previous_hp = 0
  local previous_mp = 0
  local previous_form = ""
  local was_berserk_last_turn = false
 
  function AnnounceDamage()
    local current_hp, max_hp = you.hp()
    local current_mp, max_mp = you.mp()
    --Things that increase hp/mp temporarily really mess with this
    local current_form = you.transform()
    local you_are_berserk = you.berserk()
    local max_hp_increased = false
    local max_hp_decreased = false

    if (current_form ~= previous_form) then
      if (previous_form:find("dragon") or 
          previous_form:find("statue") or
          previous_form:find("tree") or
          previous_form:find("ice")) then
        max_hp_decreased = true
      elseif (current_form:find("dragon") or 
          current_form:find("statue") or
          current_form:find("tree") or
          current_form:find("ice")) then
        max_hp_increased = true
      end
    end
    if (was_berserk_last_turn and not you_are_berserk) then
      max_hp_decreased = true
    elseif (you_are_berserk and not was_berserk_last_turn) then
      max_hp_increased = true
    end
    
    --crawl.mpr(string.format("previous_form is: %s", previous_form))
    --crawl.mpr(string.format("current_form is: %s", current_form))
    --crawl.mpr(string.format("max_hp_increased is: %s", max_hp_increased and "True" or "False"))
    --crawl.mpr(string.format("max_hp_decreased is: %s", max_hp_decreased and "True" or "False"))
    
    --crawl.mpr(string:format("you_are_berserk is: %s", you_are_berserk and "True" or "False"))
    --crawl.mpr(string:format("was_berserk_last_turn is: %s", was_berserk_last_turn and "True" or "False"))
    
    
    --Skips message on initializing game
    if previous_hp > 0 then
      local hp_difference = previous_hp - current_hp
      local mp_difference = previous_mp - current_mp
      
      if max_hp_increased or max_hp_decreased then
        if max_hp_increased then 
          crawl.mpr("<green>You now have " .. current_hp .. "/" .. max_hp .. " hp.</green>")
        else
          crawl.mpr("<yellow>You now have " .. current_hp .. "/" .. max_hp .. " hp.</yellow>")
        end
      else
        --On losing health
        if (current_hp < previous_hp) then
          if current_hp <= (max_hp * 0.30) then
            crawl.mpr("<red>You take " .. hp_difference .. " damage,</red><lightred> and have " .. current_hp .. "/" .. max_hp .. " hp.</lightred>")
          elseif current_hp <= (max_hp * 0.50) then
            crawl.mpr("<red>You take " .. hp_difference .. " damage, and have " .. current_hp .. "/" .. max_hp .. " hp.</red>")
          elseif current_hp <= (max_hp *  0.70) then
            crawl.mpr("<red>You take " .. hp_difference .. " damage,</red><yellow> and have " .. current_hp .. "/" .. max_hp .. " hp.</yellow>")
          elseif current_hp <= (max_hp * 0.90) then
            crawl.mpr("<red>You take " .. hp_difference .. " damage,</red><lightgrey> and have " .. current_hp .. "/" .. max_hp .. " hp.</lightgrey>")
          else
            crawl.mpr("<red>You take " .. hp_difference .. " damage,</red><green> and have " .. current_hp .. "/" .. max_hp .. " hp.</green>")
          end
          if hp_difference > (max_hp * 0.20) then
            crawl.mpr("<lightred>MASSIVE DAMAGE!!</lightred>")
          end
        end
  
        --On gaining more than 1 health
        if (current_hp > previous_hp) then
          --Removes the negative sign
          local health_inturn = (0 - hp_difference)
          if (health_inturn > 1) and not (current_hp == max_hp) then
            if current_hp <= (max_hp * 0.30) then
              crawl.mpr("<green>You regained " .. health_inturn .. " hp,</green><lightred> and now have " .. current_hp .. "/" .. max_hp .. " hp.</lightred>")
            elseif current_hp <= (max_hp * 0.50) then
              crawl.mpr("<green>You regained " .. health_inturn .. " hp,</green><red> and now have " .. current_hp .. "/" .. max_hp .. " hp.</red>")
            elseif current_hp <= (max_hp *  0.70) then
              crawl.mpr("<green>You regained " .. health_inturn .. " hp,</green><yellow> and now have " .. current_hp .. "/" .. max_hp .. " hp.</yellow>")
            elseif current_hp <= (max_hp * 0.90) then
              crawl.mpr("<green>You regained " .. health_inturn .. " hp,</green><lightgrey> and now have " .. current_hp .. "/" .. max_hp .. " hp.</lightgrey>")
            else
              crawl.mpr("<green>You regained " .. health_inturn .. " hp, and now have " .. current_hp .. "/" .. max_hp .. " hp.</green>")
            end
          end
          if (current_hp == max_hp) then
            crawl.mpr("<green>Health restored: " .. current_hp .. "</green>")
          end
        end
 
        --On gaining more than 1 magic
        if (current_mp > previous_mp) then
          --Removes the negative sign
          local mp_inturn = (0 - mp_difference)
          if (mp_inturn > 1) and not (current_mp == max_mp) then
            if current_mp < (max_mp * 0.25) then 
              crawl.mpr("<lightcyan>You regained " .. mp_inturn .. " mp,</lightcyan><red> and now have " .. current_mp .. "/" .. max_mp .. " mp.</red>")
            elseif current_mp < (max_mp * 0.50) then 
              crawl.mpr("<lightcyan>You regained " .. mp_inturn .. " mp,</lightcyan><yellow> and now have " .. current_mp .. "/" .. max_mp .. " mp.</yellow>")
            else
              crawl.mpr("<lightcyan>You regained " .. mp_inturn .. " mp, and now have " .. current_mp .. "/" .. max_mp .. " mp.</lightcyan>")
            end
          end
          if (current_mp == max_mp) then
            crawl.mpr("<lightcyan>MP restored: " .. current_mp .. "</lightcyan>")
          end
        end
  
        --On losing magic
        if current_mp < previous_mp then
          if current_mp <= (max_mp / 5) then
            crawl.mpr("<red>Danger: You now have " .. current_mp .. "/" ..max_mp .." mp.</red>")       
          elseif current_mp <= (max_mp / 2) then
            crawl.mpr("<yellow>Warning: You now have " .. current_mp .. "/" ..max_mp .." mp.</yellow>")
          else
            crawl.mpr("<lightcyan>You now have " .. current_mp .. "/" ..max_mp .." mp.</lightcyan>")
          end
        end
      end
    end
    
    --Set previous hp/mp and form at end of turn
    previous_hp = current_hp
    previous_mp = current_mp
    previous_form = current_form
  end  
>

####################
# Opens skill menu #
####################
<
  local need_skills_opened = true
  function OpenSkills()
    if you.turns() == 0 and need_skills_opened then
      need_skills_opened = false
      sendkeys("m")
    end
  end
>

#############
# Autofight #
#############

# Attempt to cast spell 'a' when using tab
automagic_enabled = true
automagic_stop = 50
# If we can't use magic, then do a non-magical attack
automagic_fight = true

# Do/don't throw stuff when autofighting
autofight_throw = true
autofight_throw_nomove = true
# If true. items are autofired stopping at the monsters feet (same as firing using .)
autofight_fire_stop = true

fire_order  = launcher, return
fire_order += large rock, javelin, tomahawk, dart, stone

# Prevent me from tab-fighting to death by keeping this high
autofight_stop = 60

# Enables automagic attacks
automagic_enable = false
automagic_slot = a
# Percentage of MP to stop automagic at
automagic_stop = 0
# If set to true, resort to melee when automagic_stop is active
automagic_fight = false

##############
# Autopickup #
##############

# Used
# $ = gold
# ? = scroll
# ! = potion
# : = book
# " = jewellery
# / = wand
# % = food
# } = miscellaneous
# \ = rods
# | = staves
autopickup += $?!:"/%}\|

# Unused
# ) = weapon
# ( = missiles
# [ = armour
# X = corpses

# Allows easily dropping multiple items
drop_mode += multi
# Always show the full list of items when you pick up a stack
pickup_mode += multi
# Allows followers to pick up ANYTHING (take care not to lose artifacts)
default_friendly_pickup += all

# Set Alias for Autopickup Exceptions
ae := autopickup_exceptions
ae += useless_item, dangerous_item, evil_item

# Dont pickup potion(s) of [coagulated] blood if you are not a vampire
: if you.race() ~= "Vampire" then
	ae += potions? of.*blood
: end

# Autopickup artefacts/o
ae += <artefact
: if (you.xl() < 12) or (you.god():find("Nemelex")) then
ae += <ego
: end
ae += <quick blade

# Ammo autopickup 
# Set any of the local variables to false to disable that category
<
	local pickup_arrows = false
  local pickup_bolts = false
  local pickup_stones = false
  local pickup_darts = true
  local pickup_needles = true
  local pickup_tomahawk = true
  local pickup_javelin = true
  local pickup_nets = true
	
	local function ammo_pickup(item, name)
		if pickup_arrows or known_spells["Sticks to Snakes"] then
      if name:find("arrow") then return true end
		end
    
    if pickup_bolts then
      if name:find("bolt") then return true end
		end
    
		if pickup_stones or known_spells["Sandblast"] then
      if name:find("stone") and not name:find("stone giant") then 
        return true 
      end
		end
    
		if name:find("dart") then
       if pickup_darts or name:find("dispersal") then 
        return true 
      end
		end
		
		if name:find("needle") then
      if pickup_needles or name:find("curare") then
        return true 
      end
		end
		
    if pickup_tomahawk then
			if name:find("tomahawk") then return true end
		end
    
    if name:find("javelin") then
      if pickup_javelin or name:find("returning") then
			  return true 
      end
		end
    
		if pickup_nets then
			if name:find("throwing net") then return true end
		end

		return false
	end

	add_autopickup_func(ammo_pickup)
>

# Armour autopickup by rwbarton
{
add_autopickup_func(function(it, name)
  if it.class(true) == "armour" then
    local good_slots = {cloak="Cloak", helmet="Helmet", gloves="Gloves", boots="Boots"}
    st, _ = it.subtype()
    if good_slots[st] ~= nil and items.equipped_at(good_slots[st]) == nil then
      return true
    end
    if it.name():find("curare") then
      return true
    end
  end
  return false
end)
}
  
###############
# Spell slots #
###############

# Set Alias for Spell Slots
slot := spell_slot

# Try to keep in aplhabetic order
slot += Shroud:a
slot += Freeze:a
slot += Blink:b
slot += Call Imp:c
slot += Petrify:c
slot += Confuse:c
slot += Control Undead:c
slot += Spider Form:c
slot += Conjure Flame:c
slot += Freezing Aura:c
slot += Repel Missiles:d
slot += Deflect Missiles:d
slot += Lethal Infusion:d
slot += Fireball:f
slot += Fire Brand:f
slot += Apportation:g
slot += Haste:h
slot += Abjuration:q
slot += Regeneration:r
slot += Recall:r
slot += Swiftness:s
slot += Sticky Flame:s
slot += Sticks to Snakes:s
slot += Condensation Shield:s
slot += Slow:s
slot += Song of Slaying:s
slot += Passwall:w
slot += Corona:v
slot += Iskenderun's Mystic Blast:x
slot += Call Canine Familiar:c
slot += Blade Hands:x
slot += Mephitic Cloud:x
slot += Lightning Bolt:x
slot += Stone Arrow:x
slot += Vampiric Draining:x
slot += Throw Icicle:x
slot += Throw Flame:x
slot += Throw Frost:x
slot += Lee's Rapid Deconstruction:z
slot += Iskenderun's Battlesphere:z
slot += Spectral Weapon:z
slot += Ozocubu's Armour:A
slot += Animate Skeleton:A
slot += Animate Dead:A
slot += Stoneskin:A
slot += Summon Butterflies:B
slot += Controlled Blink:B
slot += Control Teleport:C
slot += Death's Door:D
slot += Flight:F
slot += Cure Poison:P
slot += Borgnjor's Revivification:R
slot += Phase Shift:S

################
# Auto Exclude #
################

## paralyzing monsters ##
auto_exclude += [^c] wizard, eyeball, orb of eyes, sphinx, lich, ancient lich, ogre-mage, Norris
auto_exclude += vampire knight, orc sorcerer, Grinder, Rupert, Ereshkigal, Erolcha, Jory

## uniques or dangerous ##
auto_exclude += Roxanne, Sigmund, Hydra, Pikel, slave, Prince Ribbit, Snorg, Ijyb
auto_exclude += Menkaure, Duvessa, Dowan, Blork, jelly, Gastronok, Edmund
auto_exclude += Urug, Harold, Aizul, Erica, Jorgrun, ancienct lich, orb of fire
auto_exclude += Saint Roka, Boris, Mennas, Nessos, Sonja, Agnes, Wiglaf, Fannar, Louise
auto_exclude += Mara, Arachne, Xtahua, Frances, Frederick, ice statue, Polyphemus
auto_exclude += Death drake, Kirke, Hog, Jorgrun, Sojobo, Nergalle, Maud, Eustachio
auto_exclude += Crazy Yiuf, Asterion, Joseph, Terence, Grum, Donald, Natasha

###############
# Auto Travel #
###############

# Set travel delay to -1 for instant-travel, set to 1 to see travel paths
travel_delay = -1

explore_stop = glowing_items,artefacts,greedy_pickup_smart
explore_stop += stairs,shops,altars,portals,branches,runed_doors
explore_stop += greedy_sacrificeable

# Adjusts how much autoexplore favours attempting to discover room perimeters and corners. 
# At values higer than 0, autoexplore will more heavily favour visiting squares that are next to walls
# reasonable values range from 0 to 10 maybe?
explore_wall_bias = 3

# Make auto travel sacrifice corpses
sacrifice_before_explore = true
auto_sacrifice = true

# Disables key press from stopping autoexplore
travel_key_stop = false

runrest_ignore_poison = 3:30
runrest_ignore_monster += butterfly:1

trapwalk_safe_hp = dart:15,needle:25,arrow:25,bolt:30,spear:20,axe:40,blade:50

# Only stop resting when both HP/MP are full
rest_wait_both = true

# Set Alias'
stop := runrest_stop_message
ignore := runrest_ignore_message

# Jiyva Messages
: if you.god() == "Jiyva" then
	ignore += Jiyva gurgles merrily
	ignore += Jiyva appreciates your sacrifice
	ignore += Jiyva says: Divide and consume
	ignore += You hear.*splatter
: end

# Annoyances  -- Don't stop autotravel for these events
ignore += You feel.*sick
ignore += disappears in a puff of smoke
ignore += engulfed in a cloud of smoke
ignore += standing in the rain
ignore += engulfed in white fluffiness
ignore += safely over a trap
ignore += A.*toadstool withers and dies
ignore += toadstools? grow
ignore += You walk carefully through the
ignore += grinding sound
ignore += in your inventory.*rotted away
# Qazlal
ignore += The plant is engulfed
ignore += You destroy the (plant|fungus|bush)
ignore += You displace your

# Bad things -- Stop autotravel for these events
stop += found a zot trap
stop += Wait a moment
stop += You fall through a shaft
stop += An alarm trap emits a blaring wail
stop += (blundered into a|invokes the power of) Zot
stop += hear a soft click
stop += A huge blade swings out and slices into you[^r]
stop += sense of stasis
stop += flesh start
stop += (starving|devoid of blood)
stop += wrath finds you
stop += lose consciousness

# Expiring effects -- Stop autotravel for spells beginning to expire (to allow recasts)
# Haste
stop += You feel yourself slow down
# Flight
stop += You are starting to lose your buoyancy
stop += You lose control over your flight
# Necromutation
stop += Your transformation is almost over
stop += You have a feeling this form
stop += You feel yourself come back to life
# Control Teleport
stop += uncertain
# Deaths Door
stop += time is quickly running out
stop += life is in your own
# Enslavement
stop += is no longer charmed
# Shroud
stop += shroud begins to fray
stop += shroud unravels
# Swiftness
stop += start to feel a little slower
# Repel/Deflect
stop += missiles spell is about to expire

# Ghouls
: if you.race() == "Ghoul" then
	stop += smell.*(rott(ing|en)|decay)
	stop += something tasty in your inventory
: end

# Good things - Bad things wearing off
stop += contamination has completely
stop += You are no longer firmly anchored in space

#Ally actions?
#ignore += pray:
#ignore += friend_spell:
#ignore += friend_enchant:
#ignore += friend_action:
#ignore += sound:

#################
# Force Prompts #
#################

# Set Alias
more := force_more_message

# Important dungeon features
more += interdimensional caravan
more += You hear.*crackling.*archway
more += One of the plants suddenly grows acid sacs
more += Another plant grows acid sacs
more += distant snort
more += Found a gateway leading out of the Abyss
more += Found a staircase to the Ecumenical Temple
more += wave of frost
more += roar of battle
more += There is an entrance to a bailey on this level
more += oppresive heat
more += tolling of a bell
more += sound of rushing water
more += Found a frozen archway
more += Found a labyrinth entrance
more += You have a vision of.*gates?
more += Nemelex gives you another card to finish dealing
more += Fedhas invokes the elements against you
more += You have no means to grasp a wand firmly enough
more += Done waiting
more += (The|Your).*falls away!
more += acid corrodes
more += catch(es)? fire
more += freezes? and shatters?
more += cast banishment
more += cast paralyse
more += cast Torment
more += MASSIVE DAMAGE
more += Your body shudders with the violent release of wild energies
more += is duplicated
more += You feel sluggish
more += You are shrouded in an aura of darkness
more += You really shouldn't be using
more += Mutagenic energies flood into your body
more += You are surrounded by a storm which can block enemy attacks
more += resistances upon receiving elemental damage

# Translocations
more += You.*teleport [^f]
more += You blink
more += Your surroundings suddenly seem different
more += You feel strangely (unstable|stable)
more += You cannot teleport right now
more += You cannot blink right now

# Wands/Potions/Scrolls/evokes used by monsters
more += zaps a (wand|rod)
more += drinks a potion
more += reads a scroll
more += evokes.*(amulet|ring)

# Abyssal Rune
more += Found .* abyssal rune of Zot

# Dangerous Monsters
more += giant eyeball.*comes? into view
more += silver statue.*comes? into view
more += ironbrand convoker.*comes? into view
more += Lich.*comes? into view
more += The blast of calcifying dust hits you
more += You are engulfed in calcifying dust
more += begins to recite a word of recall
more += You are engulfed in dark miasma
more += swoops through the air toward you
more += orange crystal statue.*comes? into view
more += The ghost moth stares at you
more += You feel you are being watched by something
more += Its appearance distorts for a moment
more += You feel haunted
more += The octopode crusher throws you
more += Mara shimmers
more += There is a horrible\, sudden wrenching feeling in your soul
more += Mara seems to draw the.*out of itself

# Interrupts for unexpected situations
more += The.*shudders
more += Something interferes with your magic
more += You feel a genetic drift
more += You don't.* that spell
more += You fail to use your ability
more += You miscast
more += You cannot teleport right now
more += appears in a shower of sparks
more += It doesn't seem very happy
more += Some monsters swap places
more += This wand has no charges
more += You are held in a net
more += You have disarmed
more += You can't gag anything down
more += You don't have any such object
more += do not work when you're silenced
more += You cannot cast spells when silenced
more += The barbed spikes dig painfully into your body as you move
more += The water nymph flows with the water
more += You can't unwield
more += You don't have enough magic
more += You haven't enough magic at the moment
more += You feel your control is inadequate
more += Your guardian golem overheats
more += You have finished your manual
more += You can't take your gloves off to put on a ring
more += You feel your power leaking away
more += You feel your power drain away
more += Space warps horribly around you
more += Your damage is reflected back at you
more += dark mirror aura disappears
more += Space bends around you
more += The.*grabs you[^r]
more += Your attempt to break free
more += The.*is a mimic
more += The.*offers itself to Yredelemnul
more += You are blown backwards
more += Agitated ravens fly out from beneath the
more += goes berserk
more += are blown away by the wind
more += Your magical defenses are stripped away
more += appears out of thin air
more += You feel less protected from missiles
more += Your body is wracked with pain
more += surroundings become eerily quiet
more += The pull of.*song draws you forwards
more += comes (up|down) the stairs
more += The jumping spider pounces on you [^but]
more += Wisps of shadow swirl around
more += begins to accept its allies' injuries
more += doors? slams? shut
more += The vault warden activates a sealing rune
more += Miasma billows from the
more += You feel.*firmly anchored in space
more += You stumble into the trap
more += You have no appropriate body parts free
more += drinks a potion
more += You stop (a|de)scending the stairs
more += The walls disappear
more += too hungry
more += The spell fizzles
more += Your body armour is too heavy
more += stands defiantly in death's doorway
more += is no longer invulnerable
more += This potion can/'t work under stasis
more += splits in two
more += Kikubaaqudgha will now enhance your necromancy
more += The Shining One will now bless
more += You cannot cast spells while unable to breathe
more += Your fit of retching subsides
more += You are wearing\:
more += The walls and floor vibrate strangely for a moment
more += You feel your flesh start to rot away
more += You sense the presence of something unfriendly

# Interrupts for Bad things
more += Your surroundings flicker
more += You feel yourself grow more vulnerable to poison
more += You feel less vulnerable to poison
more += The poison in your body grows stronger
more += burn any scroll you tried to read
more += Your icy (shield|armour) evaporates
more += Your.*(shield|armour) melts away
more += sense of stasis
more += Your amulet of stasis
more += You smell decay. (^Yuck!)
more += The writing blurs in front of your eyes
more += You fall through a shaft
more += A huge blade swings out and slices into you
more += your magic stops regenerating
more += (blundered into a|invokes the power of) Zot
more += Ouch! That really hurt!
more += dispelling energy hits you
more += You convulse
more += You feel drained
more += You are (blasted|electrocuted)
more += You feel uncertain
more += (You are|You're) poisoned
more += (You are|You're) more poisoned
more += (You are|You're) lethally poisoned
more += (You are|You're) confused
more += (You are|You're) more confused
more += (You are|You're) too confused
more += (starving|devoid of blood)
more += You need to eat something NOW
more += You are engulfed in mutagenic fog
more += wrath finds you
more += lose consciousness
more += You are too injured to fight blindly
more += Green shoots are pushing up through the earth
more += your.*devoured
more += You are drained
more += shoots a curare
more += You feel your attacks grow feeble
more += You are blown backwards by the freezing wind
more += You are knocked back by the lance of force
more += You are knocked back by the blast of cold
more += You are knocked back by the great wave of water
more += You stumble backwards
more += You are trampled
more += Okawaru sends forces against you
more += You are slowing down.
more += You flicker for a moment.
more += You flicker back
more += The.*is unaffected
more += You (become entangled|are caught) in (a|the) (web|net)
more += The arrow of dispersal hits you[^r]
more += The forest starts to sway and rumble
more += Vines fly forth from the trees!
more += A tree reaches out and hits you!
more += You are hit by a branch
more += The.*answers the.*call
more += The air twists around and violently strikes you in flight
more += The.*engulfs you in water
more += The power of Zot is invoked against you
more += The acid corrodes your
more += You feel (dopey|clumsy|weak)
more += The air around.*erupts in flames
more += Terrible wounds (open|spread)
more += You are encased in ice
more += Your.*suddenly stops moving
more += You suddenly stop moving
more += Your surroundings seem slightly different
more += Your resistance to elements expires
more += You feel a (horrible|terrible) chill
more += You are burned terribly
more += You are mesmerised
more += The barbed spikes become lodged in your body
more += mark forms upon you
more += blows on a signal horn
more += silver sears you
more += The.*seems to speed up
more += steals.*your
more += infuriates you
more += \'s.*reflects
more += You cannot afford.*fee
more += You can move again
more += You slip out of the net
more += You.*and break free
more += You feel your flesh rotting away
more += You feel your translocation being delayed
more += There is a sealed passage
more += Something appears in a flash of light
more += You feel your rage building
more += You turn into a fleshy mushroom
more += staircase.*moves from beneath you

# Interrupts for Hell effects
more += You will not leave this place
more += Die\, mortal
more += We do not forgive those who trespass against us
more += Trespassers are not welcome here
more += You do not belong in this place
more += Leave now\, before it is too late
more += We have you now
more += You smell brimstone
more += Brimstone rains from above
more += You feel lost and a long\, long way from home
more += You shiver with fear
more += You feel a terrible foreboding
more += Something frightening happens
more += You sense an ancient evil watching you
more += You suddenly feel all small and vulnerable
more += You sense a hostile presence
more += A gut-wrenching scream fills the air
more += You hear words spoken in a strange and terrible language
more += You hear diabolical laughter

# Interrupts for Expiring spell effects
more += You feel yourself slow down
more += You are starting to lose your buoyancy
more += Your hearing returns
more += Your transformation is almost over
more += Your skin feels tender
more += You have a feeling this form
more += You feel yourself come back to life
more += time is quickly running out
more += life is in your own
more += is no longer charmed
more += Your shroud falls apart
more += Your extra speed is starting to run out
more += Your skin stops crawling
more += You are firmly grounded in the material plane once more

# Uniques
more += 27-headed.*(comes? into view|opens the)
more += Agnes.*(comes? into view|opens the)
more += Aizul.*(comes? into view|opens the)
more += Antaeus.*(comes? into view|opens the)
more += Arachne.*(comes? into view|opens the)
more += Asmodeus.*(comes? into view|opens the)
more += Asterion.*(comes? into view|opens the)
more += Azrael.*(comes? into view|opens the)
more += Blork the orc.*(comes? into view|opens the)
more += Boris.*(comes? into view|opens the)
more += Cerebov.*(comes? into view|opens the)
more += Crazy Yiuf.*(comes? into view|opens the)
more += Dispater.*(comes? into view|opens the)
more += Dissolution.*(comes? into view|opens the)
more += Donald.*(comes? into view|opens the)
more += Dowan.*(comes? into view|opens the)
more += Duvessa.*(comes? into view|opens the)
more += Edmund.*(comes? into view|opens the)
more += Ereshkigal.*(comes? into view|opens the)
more += Erica.*(comes? into view|opens the)
more += Erolcha.*(comes? into view|opens the)
more += Eustachio.*(comes? into view|opens the)
more += Fannar.*(comes? into view|opens the)
more += Frances.*(comes? into view|opens the)
more += Francis.*(comes? into view|opens the)
more += Frederick.*(comes? into view|opens the)
more += Gastronok.*(comes? into view|opens the)
more += Geryon.*(comes? into view|opens the)
more += Gloorx Vloq.*(comes? into view|opens the)
more += Grinder.*(comes? into view|opens the)
more += Grum.*(comes? into view|opens the)
more += Harold.*(comes? into view|opens the)
more += Ignacio.*(comes? into view|opens the)
more += Ijyb.*(comes? into view|opens the)
more += Ilsuiw.*(comes? into view|opens the)
more += Jessica.*(comes? into view|opens the)
more += Jorgrun.*(comes? into view|opens the)
more += Jory.*(comes? into view|opens the)
more += Joseph.*(comes? into view|opens the)
more += Josephine.*(comes? into view|opens the)
more += Jozef.*(comes? into view|opens the)
more += Khufu.*(comes? into view|opens the)
more += Kirke.*(comes? into view|opens the)
more += Lamia.*(comes? into view|opens the)
more += Lom Lobon.*(comes? into view|opens the)
more += Louise.*(comes? into view|opens the)
more += Mara.*(comes? into view|opens the)
more += Margery.*(comes? into view|opens the)
more += Maud.*(comes? into view|opens the)
more += Maurice.*(comes? into view|opens the)
more += Menkaure.*(comes? into view|opens the)
more += Mennas.*(comes? into view|opens the)
more += Mnoleg.*(comes? into view|opens the)
more += Murray.*(comes? into view|opens the)
more += Natasha.*(comes? into view|opens the)
more += Nergalle.*(comes? into view|opens the)
more += Nessos.*(comes? into view|opens the)
more += Nikola.*(comes? into view|opens the)
more += Norris.*(comes? into view|opens the)
more += Pikel.*(comes? into view|opens the)
more += Polyphemus.*(comes? into view|opens the)
more += Prince Ribbit.*(comes? into view|opens the)
more += Psyche.*(comes? into view|opens the)
more += Purgy.*(comes? into view|opens the)
more += Roxanne.*(comes? into view|opens the)
more += Rupert.*(comes? into view|opens the)
more += Saint Roka.*(comes? into view|opens the)
more += Sigmund.*(comes? into view|opens the)
more += Snorg.*(comes? into view|opens the)
more += Sojobo.*(comes? into view|opens the)
more += Sonja.*(comes? into view|opens the)
more += Terence.*(comes? into view|opens the)
more += The Lernaean hydra.*(comes? into view|opens the)
more += The royal jelly.*(comes? into view|opens the)
more += The Serpent of Hell.*(comes? into view|opens the)
more += Tiamat.*(comes? into view|opens the)
more += Urug.*(comes? into view|opens the)
more += Vashnia.*(comes? into view|opens the)
more += Wiglaf.*(comes? into view|opens the)
more += Xtahua.*(comes? into view|opens the)
more += 's ghost.*(comes? into view|opens the)
more += A player ghost.*(comes? into view|opens the)
more += shadow demons?.*(comes? into view|opens the)
more += boggarts?.*(comes? into view|opens the)
more += giant orange brains?.*(comes? into view|opens the)

# Others
more += You have reached level
more += Your scales start
more += You can now
more += You now sometimes bleed smoke
more += You can no longer
more += Your.*can no longer
more += The rod doesn't have enough magic points
more += You feel monstrous
more += Jiyva alters your body
: if you.god() == "Xom" then
	more += god:
: end

#############
# Interface #
#############

allow_self_target = prompt
sort_menus = true
#WARNING TO KEYPAD USERS: The number 7 is mapped to the letter 'y'
easy_confirm = all
confirm_butcher = never
easy_eat_chunks = true
auto_eat_chunks = true
auto_drop_chunks = yes
easy_eat_contaminated = true
equip_unequip = true

#hp_warning = 25 -- Damage Calc overrides these
#mp_warning = 25 -- Damage Calc overrides these
hp_colour = 100:green, 99:lightgray, 75:yellow, 50:lightred, 25:red
mp_colour = 100:green, 99:lightgray, 75:yellow, 50:lightred, 25:red
stat_colour = 3:red, 7:lightred
# Removes the more prompts when outputting more than one screen of messages
show_more = false
small_more = true
# Changes the turn display to show player turns (used for scoring)
show_game_turns = false

msg_min_height=7
msg_max_height=10

default_manual_training = true

##################
# Message colors #
##################

include += HDAColors.rc

####################
# Autoinscriptions #
####################

# Set Alias
ai := autoinscribe

# Overwrite annoying inscriptions with your own

# Inscribe vampiric weapons if you are not a vampire
: if you.race() ~= "Vampire" then
	ai += vampiric:!w
: end

ai += distortion:!w
ai += (Sonja|Psyche):!w
ai += (bad|dangerous)_item.*potion:!q
ai += potion of beserk rage:!q
ai += (bad|dangerous)_item.*scroll:!r
ai += rod of [^s][^t]:!a
ai += [Mm]anual of:!d
ai += dispersal:=f
ai += large rock:=f
ai += throwing net:=f, !d
ai += tome of destruction:!d
ai += royal jell:!restore

ai += pearl dragon (armour|hide):rN+
ai += fire dragon (armour|hide):rF++, rC-
ai += ice dragon (armour|hide):rC++, rF-
ai += swamp dragon (armour|hide):rP+
ai += mottled dragon (armour|hide):rSticky
ai += storm dragon (armour|hide):rElec
ai += gold dragon (armour|hide):rN+
ai += steam dragon (armour|hide):rSteam

ai += ambrosia:!magic, !confuse
ai += scrolls? of vulnerability:!r
ai += scrolls? of holy word:!r
ai += scrolls? of magic mapping:!r
ai += scrolls? of blinking:!r

ai += amulet of clarity:Clarity, !d
ai += amulet of conservation:Cons, !d
ai += amulet of faith:Faith, !P
ai += amulet of guardian spirit:Spirit
ai += amulet of rage:+Rage, !d
ai += amulet of resist corrosion:rCorr, !d
ai += amulet of resist mutation:rMut, !d
ai += amulet of stasis:Stasis, !d
ai += amulet of the gourmand:Gourmand, !d
ai += amulet of warding:Ward, rN+, !d

ai += ring of fire:rF+, rC-
ai += ring of flight:+Fly, !d
ai += ring of ice:rC+, rF-
ai += ring of invisibility:+Inv, !d
ai += ring of magical power:MP+9
ai += ring of positive energy:rN+
ai += ring of poison resistance:rP+, !d
ai += ring of protection from cold:rC+, !d
ai += ring of protection from fire:rF+, !d
ai += ring of protection from magic:MR+, !d
ai += ring of regeneration:regen, !d
ai += ring of see invisible:sInv, !d
ai += ring of sustain abilities:sustAb
ai += ring of sustenance:Hunger-
ai += ring of teleport control:cTele, !d
ai += ring of teleportation:+/*tele, !d
ai += ring of wizardry:wiz+, !d

ai += staff of air:rElec
ai += staff of cold:rC+
ai += staff of death:rN+
ai += staff of fire:rF+
ai += staff of poison:rP+
ai += staff of energy:+MP, hungerless spells, !d!a, @w1
ai += staff of wizardry:wiz+, !a
ai += staff of power:MP+17, !a
ai += staff of conjuration:!a
ai += staff of summoning:!a

: if you.god() == "Fedhas" then
	ai += fruit:!e
: end

autoinscribe_cursed = false
show_god_gift = unident

##################
# Character Dump #
##################

dump_item_origins = all
dump_item_origin_price = 100
dump_message_count = 100
#dump_order = header,hiscore,stats,misc,mutations,skills,spells,overview,inventory
#dump_order += screenshot,monlist,messages,action_counts,vaults,notes,kills
dump_order += vaults, turns_by_place, kills_by_place
dump_book_spells = false
ood_interesting = 6
note_hp_percent = 25
note_all_skill_levels = true
note_xom_effects = true
note_items += of Zot,rod,acquirement
note_messages += Your scales start
note_messages += protects you from harm
note_messages += You fall through a shaft
note_messages += [bB]anish.*Abyss
note_monsters += orb of fire,silver star,pearl dragon,ancient lich